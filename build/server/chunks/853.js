exports.id=853,exports.ids=[853],exports.modules={6258:(e,s,t)=>{Promise.resolve().then(t.bind(t,3905))},3905:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eW});var a=t(326),r=t(3240),l=t(8674),n=t(5999),i=t(7577),o=t(3456),d=t(3233),c=t(4719),m=t(6032),u=t(4019),x=t(949),h=t(3265),p=t(7824),f=t(7915),j=t(7317),g=t(6378);let v=({id:e})=>{let s=(0,j.aM)(g.h.messages.getById,{id:e});return{data:s,isLoading:void 0===s}};var b=t(9964),N=t(198),y=t(4727),w=t(1931),k=t(6801),z=t(1664);let C=(0,h.default)(async()=>{},{loadableGenerated:{modules:["features\\messages\\components\\thread.tsx -> @/components/editor"]},ssr:!1}),F=e=>{let s=new Date(e);return(0,o.z)(s)?"Today":(0,d.g)(s)?"Yesterday":(0,c.WU)(s,"EEEE, MMMM d")},S=({messageId:e,onClose:s})=>{let t=(0,p.b)(),l=(0,f.m)(),[o,d]=(0,i.useState)(null),[h,j]=(0,i.useState)(0),[g,S]=(0,i.useState)(!1),M=(0,i.useRef)(null),{mutate:_}=(0,N.g)(),{mutate:E}=(0,w.u)(),{data:A}=(0,y.i)({workspaceId:l}),{data:Z,isLoading:D}=v({id:e});console.log("message: ",Z);let{results:I,status:R,loadMore:$}=(0,b.K)({channelId:t,parentMessageId:e}),L="CanLoadMore"===R,T=async({body:s,image:a})=>{try{S(!0),M?.current?.enable(!1);let r={channelId:t,workspaceId:l,parentMessageId:e,body:s,image:void 0};if(a){let e=await E({},{throwError:!0});if(!e)throw Error("Image URL not found");let s=await fetch(e,{method:"POST",headers:{"Content-Type":a.type},body:a});if(!s.ok)throw Error("Failed to upload image");let{storageId:t}=await s.json();r.image=t}await _(r,{throwError:!0}),j(e=>e+1)}catch(e){n.Am.error("Message failed to send"),console.log(e)}finally{S(!1),M?.current?.enable(!0)}},P=I?.reduce((e,s)=>{let t=new Date(s._creationTime),a=c.WU(t,"MM-dd-yyyy");return e[a]||(e[a]=[]),e[a].unshift(s),e},{});return D||"LoadingFirstPage"===R?(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Thread"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 h-full items-center justify-center",children:[a.jsx(r.Z,{className:"size-5 animate-spin text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Message not found"})]})})]}):Z?(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Thread"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col-reverse pb-4 overflow-y-auto messages-scrollbar",children:[Object.entries(P||{}).map(([e,s])=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-center my-2 relative",children:[a.jsx("hr",{className:"absolute top-1/2 left-0 right-0 border-t border-gray-300"}),a.jsx("span",{className:"relative inline-block bg-white px-4 py-1 rounded-full text-xs border border-gray-300 shadow-sm",children:F(e)})]}),s.map((e,t)=>{let r=s[t-1],l=r&&r.user?._id===e.user?._id&&5>(0,m.X)(new Date(e._creationTime),new Date(r._creationTime));return a.jsx(k.v,{id:e._id,memberId:e.memberId,authorImage:e.user.image,isAuthor:e.memberId===A?._id,authorName:e.user.name,reactions:e.reactions,body:e.body,image:e.image,updatedAt:e.updatedAt,createdAt:e._creationTime,isEditing:o===e._id,setEditingId:d,isCompact:l,hideThreadButton:!0,threadCount:e.threadCount,threadImage:e.threadImage,threadTimestamp:e.threadTimestamp},e._id)})]},e)),a.jsx("div",{className:"h-1",ref:e=>{if(e){let s=new IntersectionObserver(([e])=>{e.isIntersecting&&L&&$()},{threshold:1});return s.observe(e),()=>s.disconnect()}}}),"LoadingMore"===R&&(0,a.jsxs)("div",{className:"text-center my-2 relative",children:[a.jsx("hr",{className:"absolute top-1/2 left-0 right-0 border-t border-gray-300"}),a.jsx("span",{className:"relative inline-block bg-white px-4 py-1 rounded-full text-xs border border-gray-300 shadow-sm",children:a.jsx(r.Z,{className:"size-4 animate-spin"})})]}),a.jsx(k.v,{hideThreadButton:!0,memberId:Z.memberId,authorImage:Z.user.image,authorName:Z.user.name,isAuthor:Z.memberId===A?._id,body:Z.body,image:Z.image,createdAt:Z._creationTime,updatedAt:Z.updatedAt,id:Z._id,reactions:Z.reactions,isEditing:o===Z._id,threadName:Z.threadName,setEditingId:d})]}),a.jsx("div",{className:"px-4",children:a.jsx(C,{onSubmit:T,innerRef:M,disabled:g,placeholder:"Reply..."},h)})]}):(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Thread"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 h-full items-center justify-center",children:[a.jsx(x.Z,{className:"size-5 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Message not found"})]})})]})};var M=t(434),_=t(5047),E=t(8393),A=t(5932),Z=t(692);let D=()=>{let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),n=(0,i.useMemo)(()=>"pending"===r,[r]),o=(0,i.useMemo)(()=>"success"===r,[r]),d=(0,i.useMemo)(()=>"error"===r,[r]),c=(0,i.useMemo)(()=>"settled"===r,[r]),m=(0,j.Db)(g.h.members.remove);return{mutate:(0,i.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await m(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[m]),data:e,error:t,isPending:n,isSuccess:o,isError:d,isSettled:c}},I=()=>{let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),n=(0,i.useMemo)(()=>"pending"===r,[r]),o=(0,i.useMemo)(()=>"success"===r,[r]),d=(0,i.useMemo)(()=>"error"===r,[r]),c=(0,i.useMemo)(()=>"settled"===r,[r]),m=(0,j.Db)(g.h.members.update);return{mutate:(0,i.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await m(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[m]),data:e,error:t,isPending:n,isSuccess:o,isError:d,isSettled:c}};var R=t(690),$=t(8062),L=t(3594),T=t(143);let P=({memberId:e,onClose:s})=>{let t=(0,_.useRouter)(),l=(0,f.m)(),[i,o]=(0,R.t)("Change role","Are you sure you want to change the selected member's role?"),[d,c]=(0,R.t)("Leave workspace","Are you sure you want to leave this workspace?"),[m,h]=(0,R.t)("Remove member","Are you sure you want to remove this member?"),{data:p,isLoading:j}=(0,y.i)({workspaceId:l}),{data:g,isLoading:v}=(0,Z.R)({id:e}),{mutate:b,isPending:N}=I(),{mutate:w,isPending:k}=D(),C=async()=>{await h()&&w({id:e},{onSuccess:()=>{n.Am.success("Member has been removed successfully"),s()},onError:()=>{n.Am.error("Failed to remove member. Are they an admin?")}})},F=async()=>{await c()&&w({id:e},{onSuccess:()=>{n.Am.success("You have left the workspace."),t.replace("/"),s()},onError:()=>{n.Am.error("Failed to leave the workspace")}})},S=async t=>{await o()&&b({id:e,role:t},{onSuccess:()=>{n.Am.success("Member role has been changed successfully"),s()},onError:()=>{n.Am.error("Failed to change member role")}})};if(v||j)return(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Thread"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 h-full items-center justify-center",children:[a.jsx(r.Z,{className:"size-5 animate-spin text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Profile not found"})]})})]});if(!g)return(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Profile"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),a.jsx("div",{children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 h-full items-center justify-center",children:[a.jsx(x.Z,{className:"size-5 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Sorry, profile not found"})]})})]});let P=g.user.name?.[0]??"M";return(0,a.jsxs)(a.Fragment,{children:[a.jsx(m,{}),a.jsx(d,{}),a.jsx(i,{}),(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"h-[49px] flex justify-between items-center px-4 border-b",children:[a.jsx("p",{className:"text-lg font-bold",children:"Profile"}),a.jsx(z.z,{onClick:s,size:"iconSm",variant:"ghost",children:a.jsx(u.Z,{className:"size-5 stroke-[1.5]"})})]}),a.jsx("div",{children:a.jsx("div",{className:"flex flex-col items-center justify-center p-4",children:(0,a.jsxs)(L.qE,{className:"max-w-[256px] max-h-[256px] size-full",children:[a.jsx(L.F$,{src:g.user.image}),a.jsx(L.Q5,{className:"aspect-square text-6xl",children:P})]})})}),(0,a.jsxs)("div",{className:"flex flex-col p-4",children:[a.jsx("p",{className:"text-xl font-bold",children:g.user.name}),p?.role==="admin"&&p?._id!==e?(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsxs)(T.h_,{children:[a.jsx(T.$F,{asChild:!0,children:(0,a.jsxs)(z.z,{variant:"outline",className:"w-full capitalize",children:[g.role," ",a.jsx(E.Z,{className:"size-4 ml-1"})]})}),a.jsx(T.AW,{className:"w-full",children:(0,a.jsxs)(T._x,{value:g.role,onValueChange:e=>S(e),children:[a.jsx(T.qB,{value:"admin",children:"Admin"}),a.jsx(T.qB,{value:"member",children:"Member"})]})})]}),a.jsx(z.z,{onClick:C,variant:"outline",className:"w-full",children:"Remove"})]}):p?._id===e&&p?.role!=="admin"?a.jsx("div",{className:"mt-4",children:a.jsx(z.z,{onClick:F,variant:"outline",className:"w-full",children:"Leave"})}):null]}),a.jsx($.Z,{}),(0,a.jsxs)("div",{className:"flex flex-col p-4",children:[a.jsx("p",{className:"text-sm font-bold mb-4",children:"Contact information"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"size-9 rounded-md bg-muted flex items-center justify-center",children:a.jsx(A.Z,{className:"size-4"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx("p",{className:"text-[13px] font-semibold text-muted-foreground",children:"Email address"}),a.jsx(M.default,{href:`mailto:${g.user.email}`,className:"text-sm hover:underline text-[#1264A3]",children:g.user.email})]})]})]})]})]})};var Y=t(4165),O=t(7045),U=t(1223);let V=({className:e,...s})=>a.jsx(O.eh,{className:(0,U.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...s}),B=O.s_,q=({withHandle:e,className:s,...t})=>a.jsx(O.OT,{className:(0,U.cn)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",s),...t,children:e&&a.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:a.jsx(Y.Z,{className:"h-2.5 w-2.5"})})});var W=t(8307),G=t(8019);let H=({workspaceId:e})=>{let s=(0,j.aM)(g.h.members.get,{workspaceId:e});return{data:s,isLoading:void 0===s}};var X=t(9013),K=t(3701),Q=t(1182),J=t(4118);let ee=i.forwardRef(({className:e,...s},t)=>a.jsx(Q.mY,{ref:t,className:(0,U.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...s}));ee.displayName=Q.mY.displayName;let es=({children:e,...s})=>a.jsx(J.Vq,{...s,children:a.jsx(J.cZ,{className:"overflow-hidden p-0 shadow-lg",children:a.jsx(ee,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:e})})}),et=i.forwardRef(({className:e,...s},t)=>(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[a.jsx(W.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx(Q.mY.Input,{ref:t,className:(0,U.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...s})]}));et.displayName=Q.mY.Input.displayName;let ea=i.forwardRef(({className:e,...s},t)=>a.jsx(Q.mY.List,{ref:t,className:(0,U.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...s}));ea.displayName=Q.mY.List.displayName;let er=i.forwardRef((e,s)=>a.jsx(Q.mY.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));er.displayName=Q.mY.Empty.displayName;let el=i.forwardRef(({className:e,...s},t)=>a.jsx(Q.mY.Group,{ref:t,className:(0,U.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...s}));el.displayName=Q.mY.Group.displayName;let en=i.forwardRef(({className:e,...s},t)=>a.jsx(Q.mY.Separator,{ref:t,className:(0,U.cn)("-mx-1 h-px bg-border",e),...s}));en.displayName=Q.mY.Separator.displayName;let ei=i.forwardRef(({className:e,...s},t)=>a.jsx(Q.mY.Item,{ref:t,className:(0,U.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...s}));ei.displayName=Q.mY.Item.displayName;let eo=()=>{let e=(0,f.m)(),s=(0,_.useRouter)(),{data:t}=(0,K.F)({id:e}),{data:r}=(0,X.B)({workspaceId:e}),{data:l}=H({workspaceId:e}),[n,o]=(0,i.useState)(!1),d=t=>{o(!1),s.push(`/workspace/${e}/channel/${t}`)},c=t=>{o(!1),s.push(`/workspace/${e}/member/${t}`)};return(0,a.jsxs)("nav",{className:"bg-[#481349] flex items-center justify-between h-10 p-1.5",children:[a.jsx("div",{className:"flex-1"}),(0,a.jsxs)("div",{className:"m-w-[280px] max-[642px] grow-[2] shrink",children:[(0,a.jsxs)(z.z,{onClick:()=>o(!0),size:"sm",className:"bg-accent/25 hover:bg-accent-25 w-full justify-start h-7 px-2",children:[a.jsx(W.Z,{className:"size-4 text-[#F5F5F5] mr-2"}),(0,a.jsxs)("span",{className:"text-[#F5F5F5] text-xs",children:["Search ",t?.name]})]}),(0,a.jsxs)(es,{open:n,onOpenChange:o,children:[a.jsx(et,{placeholder:"Search by channel or username..."}),(0,a.jsxs)(ea,{children:[a.jsx(er,{children:"No results found."}),a.jsx(el,{heading:"Channels",children:r?.map(e=>a.jsx(ei,{onSelect:()=>d(e._id),children:e.name},e._id))}),a.jsx(en,{}),a.jsx(el,{heading:"Members",children:l?.map(e=>a.jsx(ei,{onSelect:()=>c(e._id),children:e.user.name},e._id))})]})]})]}),a.jsx("div",{className:"ml-auto flex-1 flex items-center justify-end",children:a.jsx(z.z,{variant:"transparent",children:a.jsx(G.Z,{className:"size-5 text-[#F5F5F5]"})})})]})};var ed=t(9798),ec=t(4606),em=t(6507),eu=t(5919),ex=t(4669),eh=t(180);let ep=({icon:e,label:s,isActive:t,callback:r})=>(0,a.jsxs)("div",{className:(0,U.cn)("flex flex-col items-center justify-center gap-y-0.5 cursor-pointer group","Home"!==s&&"cursor-not-allowed"),children:[a.jsx(z.z,{variant:"transparent",className:(0,U.cn)("size-9 p-2 group-hover:bg-accent/20",t&&"bg-accent/20","Home"!==s&&"cursor-not-allowed"),onClick:"Home"===s?r:void 0,children:a.jsx(e,{className:"size-5 text-[#F5F5F5] group-hover:scale-110 transition-all"})}),a.jsx("span",{className:"text-[11px] text-[#F5F5F5] group-hover:text-accent",children:s})]});var ef=t(3855),ej=t(5849),eg=t(2365);let ev=()=>{let e=(0,_.useRouter)(),s=(0,f.m)(),[t,l]=(0,eg.D)(),{data:n,isLoading:i}=(0,ej.x)(),{data:o,isLoading:d}=(0,K.F)({id:s}),c=n?.filter(e=>e?._id!==s);return(0,a.jsxs)(T.h_,{modal:!1,children:[a.jsx(T.$F,{asChild:!0,className:"outline-none relative",children:a.jsx(z.z,{className:"truncate size-9 relative overflow-hidden bg-[#ABABAD] hover:bg-[#ABABAD]/75 text-slate-800 font-semibold text-xl py-3 transition-colors duration-200 rounded-b-lg",children:d?a.jsx(r.Z,{className:"size-5 animate-spin shrink-0  hover:bg-[#616061]/90 transition-colors duration-200"}):o?.name.charAt(0).toUpperCase()})}),(0,a.jsxs)(T.AW,{side:"bottom",align:"start",className:"w-64",children:[(0,a.jsxs)(T.Xi,{onClick:()=>e.push(`/workspace/${s}`),className:"cursor-pointer flex-col justify-start items-start capitalize font-bold",children:[o?.name,a.jsx("span",{className:"text-xs text-muted-foreground",children:"Active workspace"})]}),a.jsx(T.VD,{className:"my-1 bg-neutral-200/0"}),c?.map(s=>a.jsxs(T.Xi,{className:"cursor-pointer capitalize overflow-hidden hover:bg-neutral-100/50 transition-colors duration-150",onClick:()=>e.push(`/workspace/${s._id}`),children:[a.jsx("div",{className:"shrink-0 size-9 relative overflow-hidden bg-[#616061] text-[#F5F5F5] font-semibold text-lg rounded-md flex items-center justify-center mr-2 py-3 hover:bg-[#333333]/80 transition-colors duration-200 rounded-b-lg",children:s.name.charAt(0).toUpperCase()}),a.jsx("p",{className:"truncate",children:s.name})]},s._id)),c&&c?.length>0&&a.jsx(T.VD,{className:"my-1 bg-neutral-200/70"}),(0,a.jsxs)(T.Xi,{className:"cursor-pointer",onClick:()=>l(!0),children:[a.jsx("div",{className:"size-9 relative overflow-hidden bg-[#F2F2F2] text-slate-800 font-semibold text-lg rounded-md flex items-center justify-center mr-2 py-3 hover:bg-neutral-100 transition-colors duration-200 rounded-b-lg",children:a.jsx(ef.Z,{})}),"Create a new workspace"]})]})]})},eb=()=>{let e=(0,_.useRouter)(),s=(0,_.usePathname)();return(0,a.jsxs)("aside",{className:"w-[70px] h-full bg-[#481349] flex flex-col gap-y-4 items-center pt-[9px] pb-4",children:[a.jsx(ev,{}),a.jsx(ep,{icon:ed.Z,label:"Home",isActive:s.includes("/workspace"),callback:()=>{e.push("/")}}),a.jsx(ep,{icon:ec.Z,label:"DMs"}),a.jsx(ep,{icon:em.Z,label:"Activity"}),a.jsx(ep,{icon:eu.Z,label:"More"}),a.jsx("div",{className:"flex flex-col items-center justify-center gap-y-1 mt-auto",children:a.jsx(ex.k,{label:"User options",side:"right",children:a.jsx(eh.l,{})})})]})};var eN=t(9169),ey=t(939),ew=t(9423),ek=t(2494),ez=t(7886),eC=t(9360);let eF=(0,eC.j)("flex items-center gap-1.5 justify-start font-normal h-7 px-4 text-sm overflow-hidden",{variants:{variant:{default:"text-[#F9EDFFCC]",active:"text-[#481349] bg-white/90 hover:bg-white/90"}},defaultVariants:{variant:"default"}}),eS=({id:e,label:s="Member",image:t,variant:r="default"})=>{let l=(0,f.m)(),n=s.charAt(0).toUpperCase();return a.jsx(z.z,{variant:"transparent",className:(0,U.cn)(eF({variant:r})),size:"sm",asChild:!0,children:(0,a.jsxs)(M.default,{href:`/workspace/${l}/member/${e}`,children:[a.jsx(L.qE,{className:"size-5 rounded-md mr-1",children:a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-md",children:(0,a.jsxs)("div",{className:"grayscale-[15%] opacity-90 hover:grayscale-0 hover:opacity-100 transition-all duration-200 w-full h-full",children:[a.jsx(L.F$,{className:"rounded-md object-cover w-full h-full",src:t}),a.jsx(L.Q5,{className:"rounded-md !text-[#FFFFFF]/95 bg-[#E96A68]/90 text-xs w-full h-full flex items-center justify-center",children:n})]})})}),a.jsx("span",{className:"text-sm truncate",children:s})]})})},eM=(0,eC.j)("flex items-center gap-1.5 justify-start font-normal h-7 px-[18px] text-sm overflow-hidden",{variants:{variant:{default:"text-[#F9EDFFCC]",active:"text-[#481349] bg-white/90 hover:bg-white/90"}},defaultVariants:{variant:"default"}}),e_=({label:e,id:s,icon:t,variant:r})=>{let l=(0,f.m)();return a.jsx(z.z,{variant:"transparent",size:"sm",className:(0,U.cn)(eM({variant:r}),"Threads"===e&&"cursor-not-allowed","Drafts & Sent"===e&&"cursor-not-allowed"),asChild:!0,children:(0,a.jsxs)(M.default,{href:`/workspace/${l}/channel/${s}`,children:[a.jsx(t,{className:"size-3.5 mr-1 shrink-0"}),a.jsx("span",{className:"text-sm truncate",children:e})]})})};var eE=t(7685),eA=t(9508),eZ=t(7035);let eD=()=>{let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),n=(0,i.useMemo)(()=>"pending"===r,[r]),o=(0,i.useMemo)(()=>"success"===r,[r]),d=(0,i.useMemo)(()=>"error"===r,[r]),c=(0,i.useMemo)(()=>"settled"===r,[r]),m=(0,j.Db)(g.h.workspaces.update);return{mutate:(0,i.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await m(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[m]),data:e,error:t,isPending:n,isSuccess:o,isError:d,isSettled:c}},eI=()=>{let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),n=(0,i.useMemo)(()=>"pending"===r,[r]),o=(0,i.useMemo)(()=>"success"===r,[r]),d=(0,i.useMemo)(()=>"error"===r,[r]),c=(0,i.useMemo)(()=>"settled"===r,[r]),m=(0,j.Db)(g.h.workspaces.remove);return{mutate:(0,i.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await m(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[m]),data:e,error:t,isPending:n,isSuccess:o,isError:d,isSettled:c}};var eR=t(1190);let e$=({open:e,setOpen:s,initialValue:t})=>{let r=(0,_.useRouter)(),l=(0,f.m)(),[o,d]=(0,R.t)("Are you sure you want to continue?","This action cannot be undone. Once deleted, your data will be permanently removed from our servers."),[c,m]=(0,i.useState)(t),[u,x]=(0,i.useState)(!1),{mutate:h,isPending:p}=eD(),{mutate:j,isPending:g}=eI(),v=async()=>{await d()&&j({id:l},{onSuccess:()=>{n.Am.success("Workspace removed successfully."),r.replace("/")},onError:()=>{n.Am.error("Failed to remove workspace. Please try again.")}})};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(o,{}),a.jsx(J.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(J.cZ,{className:"p-0 bg-gray-50 overflow-hidden rounded-xl",children:[a.jsx(J.fK,{className:"p-4 border-b bg-gray-100 transition-colors",children:a.jsx(J.$N,{children:t})}),(0,a.jsxs)("div",{className:"px-4 pb-4 flex flex-col gap-y-2",children:[(0,a.jsxs)(J.Vq,{open:u,onOpenChange:e=>{e&&m(t),x(e)},children:[a.jsx(J.hg,{children:(0,a.jsxs)("div",{className:"px-5 py-4 bg-gray-100 rounded-lg border cursor-pointer hover:bg-gray-50 hover:shadow-sm    transition-all duration-150 ease-in-out",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Workspace name"}),a.jsx("p",{className:"text-sm text-[#1264A3] font-semibold hover:underline    transition-colors duration-150",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1 text-left",children:t})]})}),(0,a.jsxs)(J.cZ,{children:[a.jsx(J.fK,{children:a.jsx(J.$N,{children:"Rename current workspace"})}),(0,a.jsxs)("form",{className:"space-y-4",onSubmit:e=>{e.preventDefault(),h({id:l,name:c},{onSuccess:()=>{x(!1),n.Am.success("Workspace updated successfully.")},onError:()=>{n.Am.error("Failed to update workspace. Please try again.")}})},children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Workspace name"}),a.jsx(eR.I,{value:c,disabled:p,onChange:e=>m(e.target.value),required:!0,autoFocus:!0,minLength:3,maxLength:80,placeholder:'Workspace name e.g. "Work", "Personal", "Home"',className:"h-10 border-gray-300"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[c.length,"/80 characters"]})]}),(0,a.jsxs)(J.cN,{children:[a.jsx(J.GG,{asChild:!0,children:a.jsx(z.z,{type:"button",variant:"outline",disabled:p,children:"Cancel"})}),a.jsx(z.z,{type:"submit",disabled:!c.trim()||p||c===t,children:p?"Saving...":"Save"})]})]})]})]}),(0,a.jsxs)("button",{disabled:g,onClick:v,className:"flex items-center gap-x-2 px-5 py-4 bg-gray-100 rounded-xl border border-gray-200 cursor-pointer hover:bg-rose-50 text-rose-600 hover:text-rose-700 transition-all duration-150 ease-in-out hover:shadow-sm",children:[a.jsx(eZ.Z,{className:"size-4"}),a.jsx("p",{className:"text-sm font-semibold",children:"Delete workspace"})]})]})]})})]})};var eL=t(3810),eT=t(1468);let eP=()=>{let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),n=(0,i.useMemo)(()=>"pending"===r,[r]),o=(0,i.useMemo)(()=>"success"===r,[r]),d=(0,i.useMemo)(()=>"error"===r,[r]),c=(0,i.useMemo)(()=>"settled"===r,[r]),m=(0,j.Db)(g.h.workspaces.newJoinCode);return{mutate:(0,i.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await m(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[m]),data:e,error:t,isPending:n,isSuccess:o,isError:d,isSettled:c}},eY=({open:e,setOpen:s,name:t,joinCode:r})=>{let l=(0,f.m)(),[i,o]=(0,R.t)("Generate a New Workspace Invite Code?","Creating a new invite code will deactivate the current one. Only members with the new code can join the workspace."),{mutate:d}=eP(),c=async()=>{await o()&&d({workspaceId:l},{onSuccess:()=>{n.Am.success("Success! Your new invite code is ready to use.")},onError:()=>{n.Am.error("Error: Unable to regenerate the invite code.")}})};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(i,{}),a.jsx(J.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(J.cZ,{className:"p-6 max-w-xl bg-white rounded-lg shadow-lg transition-opacity duration-300 ease-in-out","aria-labelledby":"modal-title","aria-describedby":"modal-description",children:[(0,a.jsxs)(J.fK,{className:"space-y-2",children:[(0,a.jsxs)(J.$N,{id:"modal-title",className:"text-xl font-semibold text-gray-900",children:["Invite to ",t]}),a.jsx(J.Be,{id:"modal-description",className:"text-sm text-gray-600",children:"Share the invite code and link below to get others into your workspace."})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4 py-8",children:[a.jsx("p",{className:"uppercase text-4xl font-semibold tracking-wide text-gray-800",children:r}),(0,a.jsxs)(z.z,{variant:"outline",size:"lg",onClick:()=>{let e=`${window.location.origin}/join/${l}?${r}`;navigator.clipboard.writeText(e).then(()=>{n.Am.success("Invite link copied to clipboard")}).catch(e=>{n.Am.error("Failed to copy invite link"),console.log(e)})},className:"flex items-center space-x-2 text-blue-600 border-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Copy Invite Link",children:[a.jsx("span",{children:"Copy Invite Link"}),a.jsx(eL.Z,{className:"w-5 h-5"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsxs)(z.z,{onClick:c,variant:"outline",children:["New code",a.jsx(eT.Z,{className:"size-4 ml-2"})]}),a.jsx(J.GG,{asChild:!0,children:a.jsx(z.z,{children:"Close"})})]})]})})]})},eO=({workspace:e,isAdmin:s})=>{let[t,r]=(0,i.useState)(!1),[l,n]=(0,i.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[a.jsx(eY,{open:l,setOpen:n,name:e.name,joinCode:e.joinCode}),a.jsx(e$,{open:t,setOpen:r,initialValue:e.name}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 h-[49px] gap-0.5",children:[(0,a.jsxs)(T.h_,{children:[a.jsx(T.$F,{asChild:!0,children:(0,a.jsxs)(z.z,{variant:"transparent",className:"font-semibold text-lg w-auto p-1.5 overflow-hidden",size:"sm",children:[a.jsx("span",{className:"truncate",children:e?.name}),a.jsx(E.Z,{className:"size-4 ml-0.5 shrink-0"})]})}),(0,a.jsxs)(T.AW,{side:"bottom",align:"start",className:"w-64",children:[(0,a.jsxs)(T.Xi,{className:"cursor-pointer capitalize",children:[a.jsx("div",{className:"size-9 relative overflow-hidden bg-[#616061] text-[#F5F5F5] font-semibold text-xl rounded-md flex items-center justify-center mr-2",children:e.name.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{className:"flex flex-col items-start",children:[a.jsx("p",{className:"font-bold",children:e.name}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Active workspace"})]})]}),s&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(T.VD,{}),(0,a.jsxs)(T.Xi,{className:"cursor-pointer py-2",onClick:()=>n(!0),children:["Invite users to ",e.name]}),a.jsx(T.Xi,{className:"cursor-pointer py-2",onClick:()=>r(!0),children:"Preferences"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5",children:[a.jsx(ex.k,{label:"Filter conversations",side:"bottom",children:a.jsx(z.z,{variant:"transparent",className:"cursor-not-allowed",size:"iconSm",children:a.jsx(eE.Z,{})})}),a.jsx(ex.k,{label:"New message",side:"bottom",children:a.jsx(z.z,{variant:"transparent",className:"cursor-not-allowed",size:"iconSm",children:a.jsx(eA.Z,{})})})]})]})]})};var eU=t(5786),eV=t(4046);let eB=({children:e,label:s,hint:t,onNew:r})=>{let[l,n]=(0,eU.Z)(!0);return(0,a.jsxs)("div",{className:"flex flex-col mt-3 px-2",children:[(0,a.jsxs)("div",{className:"flex items-center px-3.5 group",children:[(0,a.jsxs)(z.z,{variant:"transparent",className:"p-0.5 text-sm text-[#F9EDFFCC] shrink-0 size-6",onClick:n,children:[" ",a.jsx(eV.qL$,{className:(0,U.cn)("size-4 transition-transform",!l&&"-rotate-90")})]}),a.jsx(z.z,{variant:"transparent",size:"sm",className:"group px-1.5 text-sm text-[#F9EDFFCC] h-[28px] justify-start overflow-hidden items-center mr-auto",children:a.jsx("span",{className:"truncate",children:s})}),r&&a.jsx(ex.k,{label:t,side:"top",align:"center",children:a.jsx(z.z,{variant:"transparent",className:(0,U.cn)("opacity-0 group-hover:opacity-100 transition-opacity justify-center p-0.5 text-sm text-[#F9EDFFCC] size-6 shrink-0","Direct Messages"===s&&"cursor-not-allowed"),onClick:r,children:a.jsx(ef.Z,{className:"size-5"})})})]}),l&&e]})},eq=()=>{let e=(0,ez.H)(),s=(0,p.b)(),t=(0,f.m)(),[l,n]=(0,ek.O)(),{data:i,isLoading:o}=(0,y.i)({workspaceId:t}),{data:d,isLoading:c}=(0,K.F)({id:t}),{data:m,isLoading:u}=(0,X.B)({workspaceId:t}),{data:h,isLoading:j}=H({workspaceId:t});return c||o?a.jsx("div",{className:"flex flex-col h-full items-center justify-center bg-[#5E2C5F]",children:a.jsx(r.Z,{className:"size-5 animate-spin text-[#F5F5F5]"})}):d&&i?(0,a.jsxs)("div",{className:"flex flex-col bg-[#5E2C5F] h-full",children:[a.jsx(eO,{workspace:d,isAdmin:"admin"===i.role}),(0,a.jsxs)("div",{className:"flex flex-col px-2 mt-3",children:[a.jsx(e_,{label:"Threads",icon:eN.Z,id:"threads"}),a.jsx(e_,{label:"Drafts & Sent",icon:ey.Z,id:"drafts"})]}),a.jsx(eB,{label:"Channels",hint:"New channel",onNew:"admin"===i.role?()=>n(!0):void 0,children:m?.map(e=>a.jsx(e_,{icon:ew.Z,label:e.name,id:e._id,variant:s===e._id?"active":"default"},e._id))}),a.jsx(eB,{label:"Direct Messages",hint:"New direct message",onNew:()=>{},children:h?.map(s=>a.jsx(eS,{id:s._id,label:s.user.name,image:s.user.image,variant:s._id===e?"active":"default"},s._id))})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-y-2 h-full items-center justify-center bg-[#5E2C5F]",children:[a.jsx(x.Z,{className:"size-5 text-[#F5F5F5]"}),a.jsx("p",{className:"text-sm text-[#F5F5F5]",children:"Sorry, workspace not found."})]})},eW=({children:e})=>{let{parentMessageId:s,profileMemberId:t,onClose:n}=(0,l.u)();return(0,a.jsxs)("div",{className:"h-full",children:[a.jsx(eo,{}),(0,a.jsxs)("div",{className:"flex h-[calc(100vh-40px)]",children:[a.jsx(eb,{}),(0,a.jsxs)(V,{direction:"horizontal",autoSaveId:"ca-workspace-layout",children:[a.jsx(B,{defaultSize:20,minSize:11,className:"bg-[#5E2C5F]",children:a.jsx(eq,{})}),a.jsx(q,{withHandle:!0}),a.jsx(B,{minSize:20,defaultSize:80,children:e}),(!!s||!!t)&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(q,{withHandle:!0}),a.jsx(B,{minSize:20,defaultSize:29,children:s?a.jsx(S,{messageId:s,onClose:n}):t?a.jsx(P,{memberId:t,onClose:n}):a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(r.Z,{className:"size-5 animate-spin text-muted-foreground"})})})]})]})]})]})}},4669:(e,s,t)=>{"use strict";t.d(s,{k:()=>l});var a=t(326),r=t(2631);let l=({label:e,children:s,side:t,align:l})=>a.jsx(r.pn,{children:(0,a.jsxs)(r.u,{delayDuration:50,children:[a.jsx(r.aJ,{asChild:!0,children:a.jsx("div",{children:s})}),a.jsx(r._v,{side:t,align:l,className:"bg-[#242424] text-[#F5F5F5] border border-[#F5F5F5]/5 animate-in fade-in-0 backdrop-blur-sm shadow-lg zoom-in-95",children:a.jsx("p",{className:"font-medium text-xs",children:e})})]})})},6801:(e,s,t)=>{"use strict";t.d(s,{v:()=>B});var a=t(326),r=t(5999),l=t(3265),n=t(3456),i=t(3233),o=t(4719),d=t(7317),c=t(7577),m=t(6378);let u=()=>{let[e,s]=(0,c.useState)(null),[t,a]=(0,c.useState)(null),[r,l]=(0,c.useState)(null),n=(0,c.useMemo)(()=>"pending"===r,[r]),i=(0,c.useMemo)(()=>"success"===r,[r]),o=(0,c.useMemo)(()=>"error"===r,[r]),u=(0,c.useMemo)(()=>"settled"===r,[r]),x=(0,d.Db)(m.h.messages.remove);return{mutate:(0,c.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await x(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[x]),data:e,error:t,isPending:n,isSuccess:i,isError:o,isSettled:u}},x=()=>{let[e,s]=(0,c.useState)(null),[t,a]=(0,c.useState)(null),[r,l]=(0,c.useState)(null),n=(0,c.useMemo)(()=>"pending"===r,[r]),i=(0,c.useMemo)(()=>"success"===r,[r]),o=(0,c.useMemo)(()=>"error"===r,[r]),u=(0,c.useMemo)(()=>"settled"===r,[r]),x=(0,d.Db)(m.h.messages.update);return{mutate:(0,c.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await x(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[x]),data:e,error:t,isPending:n,isSuccess:i,isError:o,isSettled:u}};var h=t(1223),p=t(8674),f=t(690),j=t(4669),g=t(5515),v=t(9169),b=t(4389),N=t(7035),y=t(1664),w=t(9322),k=t(4964);let z=k.fC,C=k.xz,F=c.forwardRef(({className:e,align:s="center",sideOffset:t=4,...r},l)=>a.jsx(k.h_,{children:a.jsx(k.VY,{ref:l,align:s,sideOffset:t,className:(0,h.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));F.displayName=k.VY.displayName;var S=t(2631);let M=({children:e,hint:s="Emoji",onEmojiSelect:t})=>{let[r,l]=(0,c.useState)(!1),[n,i]=(0,c.useState)(!1);return a.jsx(S.pn,{children:(0,a.jsxs)(z,{open:r,onOpenChange:l,children:[(0,a.jsxs)(S.u,{open:n,onOpenChange:i,delayDuration:50,children:[a.jsx(C,{asChild:!0,children:a.jsx(S.aJ,{asChild:!0,children:e})}),a.jsx(S._v,{className:"bg-[#242424] text-[#F5F5F5] border border-[#F5F5F5]/5",children:a.jsx("p",{className:"font-medium text-xs",children:s})})]}),a.jsx(F,{className:"p-0 w-full border-none shadow-none",children:a.jsx(w.ZP,{onEmojiClick:e=>{t(e.emoji),l(!1),setTimeout(()=>{i(!1)},500)}})})]})})},_=({isAuthor:e,isPending:s,handleEdit:t,handleThread:r,handleDelete:l,handleReaction:n,hideThreadButton:i})=>a.jsx("div",{className:"absolute top-0 right-5 hover:top-0.5",children:(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 border bg-white rounded-md shadow-sm transform hover:scale-105 transition-all flex flex-row",children:[a.jsx(M,{hint:"Add reaction",onEmojiSelect:e=>n(e),children:a.jsx(y.z,{className:"hover:translate-x-[-4] hover:translate-y-[4] transition-all",variant:"ghost",size:"iconSm",disabled:s,children:a.jsx(g.Z,{className:"size-4"})})}),!i&&a.jsx(j.k,{label:"Reply in thread",children:a.jsx(y.z,{className:"hover:translate-x-[-4] hover:translate-y-[-4] transition-all",variant:"ghost",size:"iconSm",disabled:s,onClick:r,children:a.jsx(v.Z,{className:"size-4"})})}),e&&a.jsx(j.k,{label:"Edit message",children:a.jsx(y.z,{className:"hover:translate-x-[-4] hover:translate-y-[4] transition-all",variant:"ghost",size:"iconSm",disabled:s,onClick:t,children:a.jsx(b.Z,{className:"size-4"})})}),e&&a.jsx(j.k,{label:"Delete message",children:a.jsx(y.z,{className:"hover:translate-x-[-4] hover:translate-y-[-4] transition-all",variant:"ghost",size:"iconSm",disabled:s,onClick:l,children:a.jsx(N.Z,{className:"size-4"})})})]})});var E=t(4118);let A=({url:e})=>e?(0,a.jsxs)(E.Vq,{children:[a.jsx(E.hg,{children:a.jsx("div",{className:"relative overflow-hidden max-w-[360px] border rounded-lg my-2 cursor-zoom-in",children:a.jsx("img",{src:e,alt:"Message image",className:"rounded-md object-cover size-full"})})}),a.jsx(E.cZ,{className:"max-w-[800px] border-none bg-transparent p-0 shadow-none",children:a.jsx("img",{src:e,alt:"Message image",className:"rounded-md object-cover size-full"})})]}):null;var Z=t(9183),D=t(2316),I=t(3594);let R=({count:e,image:s,name:t="Member",timestamp:r,onClick:l})=>{let n=t.charAt(0).toUpperCase();return e&&r?(0,a.jsxs)("button",{onClick:l,className:"p-1 rounded-md hover:bg-white border-transparent hover:border-border flex items-center justify-start group/thread-bar transition max-w-[600px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[(0,a.jsxs)(I.qE,{className:"size-6 shrink-0",children:[a.jsx(I.F$,{src:s}),a.jsx(I.Q5,{children:n})]}),(0,a.jsxs)("span",{className:"text-xs text-sky-700 hover:underline font-bold truncate",children:[e," ",e>1?"replies":"reply"]}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground truncate group-hover/thread-bar:hidden block",children:["Last reply ",(0,D.Q)(r,{addSuffix:!0})]}),a.jsx("span",{className:"text-xs text-muted-foreground truncate group-hover/thread-bar:block hidden",children:"View thread"})]}),a.jsx(Z.Z,{className:"size-4 text-muted-foreground ml-auto opacity-0 group-hover/thread-bar:opacity-100 transition shrink-0"})]}):null};var $=t(4835),L=t(7915),T=t(4727);let P=({data:e,onChange:s})=>{let t=(0,L.m)(),{data:r}=(0,T.i)({workspaceId:t}),l=r?._id;return 0!==e.length&&l?(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-1 mb-1",children:[e.map(e=>a.jsx(j.k,{label:`${e.count} ${1===e.count?"person":"people"} reacted with ${e.value}`,children:(0,a.jsxs)("button",{onClick:()=>s(e.value),className:(0,h.cn)("h-6 px-2 rounded-full bg-slate-200/70 border border-slate-300 text-slate-800 flex items-center gap-x-1",e.memberIds.includes(l)&&"bg-[#F87171]/20 border-[#F87171]/60 text-[#F5F5F5]"),children:[e.value,a.jsx("span",{className:(0,h.cn)("text-xs font-semibold text-muted-foreground",e.memberIds.includes(l)&&"text-[#F87171]"),children:e.count})]})},e._id)),a.jsx(M,{hint:"Add reaction",onEmojiSelect:e=>s(e),children:a.jsx("button",{className:"h-7 px-3 rounded-full bg-slate-200/70 border border-transparent hover:border-slate-500/80 text-slate-800 flex items-center gap-x-1",children:a.jsx($.rIg,{className:"size-4"})})})]}):null},Y=()=>{let[e,s]=(0,c.useState)(null),[t,a]=(0,c.useState)(null),[r,l]=(0,c.useState)(null),n=(0,c.useMemo)(()=>"pending"===r,[r]),i=(0,c.useMemo)(()=>"success"===r,[r]),o=(0,c.useMemo)(()=>"error"===r,[r]),u=(0,c.useMemo)(()=>"settled"===r,[r]),x=(0,d.Db)(m.h.reactions.toggle);return{mutate:(0,c.useCallback)(async(e,t)=>{try{s(null),a(null),l("pending");let r=await x(e);return t?.onSuccess?.(r),r}catch(e){if(l("error"),t?.onError?.(e),t?.throwError)throw e}finally{l("settled"),t?.onSettled?.()}},[x]),data:e,error:t,isPending:n,isSuccess:i,isError:o,isSettled:u}},O=(0,l.default)(async()=>{},{loadableGenerated:{modules:["components\\message.tsx -> @/components/editor"]},ssr:!1}),U=(0,l.default)(async()=>{},{loadableGenerated:{modules:["components\\message.tsx -> @/components/renderer"]},ssr:!1}),V=e=>`${(0,n.z)(e)?"Today":(0,i.g)(e)?"Yesterday":(0,o.WU)(e,"MMM d, yyyy")} at ${(0,o.WU)(e,"h:mm:ss a")}`,B=({id:e,isAuthor:s,memberId:t,authorImage:l,authorName:n="Member",reactions:i,body:d,image:c,createdAt:m,updatedAt:g,isEditing:v,isCompact:b,setEditingId:N,hideThreadButton:y,threadCount:w,threadImage:k,threadName:z,threadTimestamp:C})=>{let{parentMessageId:F,onOpenMessage:S,onOpenProfile:M,onClose:E}=(0,p.u)(),[Z,D]=(0,f.t)("Permanently Delete Message","This message will be permanently removed from the conversation and cannot be recovered. Are you sure you want to proceed?"),{mutate:$,isPending:L}=x(),{mutate:T,isPending:B}=u(),{mutate:q,isPending:W}=Y(),G=L||W,H=s=>{q({messageId:e,value:s},{onError:()=>{r.Am.error("Failed to toggle reaction")}})},X=async()=>{await D()&&setTimeout(()=>{T({id:e},{onSuccess:()=>{r.Am.success("Message successfully deleted"),F===e&&E()},onError:()=>{r.Am.error("Failed to delete message. Please reload and try again.")}})},350)},K=({body:s})=>{$({id:e,body:s},{onSuccess:()=>{r.Am.success("Message updated successfully"),N(null)},onError:()=>{r.Am.error("Failed to update message. Please try again.")}})};if(b)return(0,a.jsxs)(a.Fragment,{children:[a.jsx(Z,{}),(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col gap-2 p-1.5 px-5 scale-100 opacity-100 hover:bg-gray-100/60 group relative","transform transition-all",v&&"bg-[#F2C74433] hover:bg-[#F2C74433]",B&&"bg-rose-500/65 transform transition-all scale-y-0 opacity-0 origin-bottom duration-200"),children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx(j.k,{label:V(new Date(m)),children:a.jsx("button",{className:"text-xs text-muted-foreground opacity-0 group-hover:opacity-100 w-[40px] leading-[22px] text-center hover:underline",children:(0,o.WU)(new Date(m),"hh:mm")})}),v?a.jsx("div",{className:"w-full h-full",children:a.jsx(O,{onSubmit:K,disabled:G,defaultValue:JSON.parse(d),onCancel:()=>N(null),variant:"update"})}):(0,a.jsxs)("div",{className:"flex flex-col w-full",children:[a.jsx(U,{value:d}),a.jsx(A,{url:c}),g?a.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"}):null,a.jsx(P,{data:i,onChange:H}),a.jsx(R,{count:w,image:k,name:z,timestamp:C,onClick:()=>S(e)})]})]}),!v&&a.jsx(_,{isAuthor:s,isPending:!1,handleEdit:()=>N(e),handleThread:()=>S(e),handleDelete:X,handleReaction:H,hideThreadButton:y})]})]});let Q=n.charAt(0).toUpperCase();return(0,a.jsxs)(a.Fragment,{children:[a.jsx(Z,{}),(0,a.jsxs)("div",{className:(0,h.cn)("flex flex-col gap-2 p-1.5 px-5 scale-100 opacity-100 hover:bg-gray-100/60 group relative","transform transition-all",v&&"bg-[#F2C74433] hover:bg-[#F2C74433]",B&&"bg-rose-500/65 transform transition-all scale-y-0 opacity-0 origin-bottom duration-200"),children:[(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[a.jsx("button",{onClick:()=>M(t),children:(0,a.jsxs)(I.qE,{children:[a.jsx(I.F$,{src:l}),a.jsx(I.Q5,{children:Q})]})}),v?a.jsx("div",{className:"w-full h-full",children:a.jsx(O,{onSubmit:K,disabled:G,defaultValue:JSON.parse(d),onCancel:()=>N(null),variant:"update"})}):(0,a.jsxs)("div",{className:"flex flex-col w-full overflow-hidden",children:[(0,a.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[a.jsx("button",{onClick:()=>M(t),className:"font-bold text-primary hover:underline",children:n}),a.jsx(j.k,{label:V(new Date(m)),children:a.jsx("button",{className:"text-xs text-muted-foreground hover:underline",children:(0,o.WU)(new Date(m),"h:mm a")})})]}),a.jsx(U,{value:d}),a.jsx(A,{url:c}),g?a.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"}):null,a.jsx(P,{data:i,onChange:H}),a.jsx(R,{count:w,image:k,name:z,timestamp:C,onClick:()=>S(e)})]})]}),!v&&a.jsx(_,{isAuthor:s,isPending:G,handleEdit:()=>N(e),handleThread:()=>S(e),handleDelete:X,handleReaction:H,hideThreadButton:y})]})]})}},3594:(e,s,t)=>{"use strict";t.d(s,{F$:()=>o,Q5:()=>d,qE:()=>i});var a=t(326),r=t(7577),l=t(4150),n=t(1223);let i=r.forwardRef(({className:e,...s},t)=>a.jsx(l.fC,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-md",e),...s}));i.displayName=l.fC.displayName;let o=r.forwardRef(({className:e,...s},t)=>a.jsx(l.Ee,{ref:t,className:(0,n.cn)("aspect-square h-full w-full object-cover",e),...s}));o.displayName=l.Ee.displayName;let d=r.forwardRef(({className:e,...s},t)=>a.jsx(l.NY,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-md bg-[#EB786B] text-[#F5F5F5] text-sm",e),...s}));d.displayName=l.NY.displayName},143:(e,s,t)=>{"use strict";t.d(s,{$F:()=>m,AW:()=>x,VD:()=>f,Xi:()=>h,_x:()=>u,h_:()=>c,qB:()=>p});var a=t(326),r=t(7577),l=t(1865),n=t(9183),i=t(2933),o=t(3982),d=t(1223);let c=l.fC,m=l.xz;l.ZA,l.Uv,l.Tr;let u=l.Ee;r.forwardRef(({className:e,inset:s,children:t,...r},i)=>(0,a.jsxs)(l.fF,{ref:i,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",e),...r,children:[t,a.jsx(n.Z,{className:"ml-auto"})]})).displayName=l.fF.displayName,r.forwardRef(({className:e,...s},t)=>a.jsx(l.tu,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})).displayName=l.tu.displayName;let x=r.forwardRef(({className:e,sideOffset:s=4,...t},r)=>a.jsx(l.Uv,{children:a.jsx(l.VY,{ref:r,sideOffset:s,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t})}));x.displayName=l.VY.displayName;let h=r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(l.ck,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",e),...t}));h.displayName=l.ck.displayName,r.forwardRef(({className:e,children:s,checked:t,...r},n)=>(0,a.jsxs)(l.oC,{ref:n,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:t,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(l.wU,{children:a.jsx(i.Z,{className:"h-4 w-4"})})}),s]})).displayName=l.oC.displayName;let p=r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(l.Rk,{ref:r,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(l.wU,{children:a.jsx(o.Z,{className:"h-2 w-2 fill-current"})})}),s]}));p.displayName=l.Rk.displayName,r.forwardRef(({className:e,inset:s,...t},r)=>a.jsx(l.__,{ref:r,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",e),...t})).displayName=l.__.displayName;let f=r.forwardRef(({className:e,...s},t)=>a.jsx(l.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...s}));f.displayName=l.Z0.displayName},8062:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var a=t(326),r=t(7577),l=t(220),n=t(1223);let i=r.forwardRef(({className:e,orientation:s="horizontal",decorative:t=!0,...r},i)=>a.jsx(l.f,{ref:i,decorative:t,orientation:s,className:(0,n.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...r}));i.displayName=l.f.displayName},2631:(e,s,t)=>{"use strict";t.d(s,{_v:()=>c,aJ:()=>d,pn:()=>i,u:()=>o});var a=t(326),r=t(7577),l=t(3450),n=t(1223);let i=l.zt,o=l.fC,d=l.xz,c=r.forwardRef(({className:e,sideOffset:s=4,...t},r)=>a.jsx(l.VY,{ref:r,sideOffset:s,className:(0,n.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));c.displayName=l.VY.displayName},180:(e,s,t)=>{"use strict";t.d(s,{l:()=>u});var a=t(326),r=t(3240),l=t(1810),n=t(878),i=t(143),o=t(7317),d=t(6378);let c=()=>{let e=(0,o.aM)(d.h.users.current);return{data:e,isLoading:void 0===e}};var m=t(3594);let u=()=>{let{signOut:e}=(0,n.X$)(),{data:s,isLoading:t}=c();if(t)return a.jsx(r.Z,{className:"size-4 animate-spin text-muted-foreground"});if(!s)return null;let{image:o,name:d}=s,u=d.charAt(0).toUpperCase();return(0,a.jsxs)(i.h_,{modal:!1,children:[a.jsx(i.$F,{className:"outline-none relative",children:a.jsx(m.qE,{className:"rounded-md size-10 hover:opacity-75 transition",children:a.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-md",children:(0,a.jsxs)("div",{className:"grayscale-[15%] opacity-90 hover:grayscale-0 transition-all duration-200 w-full h-full",children:[a.jsx(m.F$,{className:"rounded-md object-cover w-full h-full",alt:d,src:o}),a.jsx(m.Q5,{className:"rounded-md !text-[#F5F5F5] bg-[#5C3B58] w-full h-full flex items-center justify-center",children:u})]})})})}),a.jsx(i.AW,{align:"center",side:"right",className:"w-60",children:(0,a.jsxs)(i.Xi,{onClick:()=>e(),className:"h-10 cursor-pointer",children:[a.jsx(l.Z,{className:"size-4 mr-2"}),"Log out"]})})]})}},9013:(e,s,t)=>{"use strict";t.d(s,{B:()=>l});var a=t(7317),r=t(6378);let l=({workspaceId:e})=>{let s=(0,a.aM)(r.h.channels.get,{workspaceId:e});return{data:s,isLoading:void 0===s}}},4727:(e,s,t)=>{"use strict";t.d(s,{i:()=>l});var a=t(7317),r=t(6378);let l=({workspaceId:e})=>{let s=(0,a.aM)(r.h.members.currentMember,{workspaceId:e});return{data:s,isLoading:void 0===s}}},692:(e,s,t)=>{"use strict";t.d(s,{R:()=>l});var a=t(7317),r=t(6378);let l=({id:e})=>{let s=(0,a.aM)(r.h.members.getById,{id:e});return{data:s,isLoading:void 0===s}}},198:(e,s,t)=>{"use strict";t.d(s,{g:()=>n});var a=t(7317),r=t(7577),l=t(6378);let n=()=>{let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(null),d=(0,r.useMemo)(()=>"pending"===i,[i]),c=(0,r.useMemo)(()=>"success"===i,[i]),m=(0,r.useMemo)(()=>"error"===i,[i]),u=(0,r.useMemo)(()=>"settled"===i,[i]),x=(0,a.Db)(l.h.messages.create);return{mutate:(0,r.useCallback)(async(e,t)=>{try{s(null),n(null),o("pending");let a=await x(e);return t?.onSuccess?.(a),a}catch(e){if(o("error"),t?.onError?.(e),t?.throwError)throw e}finally{o("settled"),t?.onSettled?.()}},[x]),data:e,error:t,isPending:d,isSuccess:c,isError:m,isSettled:u}}},9964:(e,s,t)=>{"use strict";t.d(s,{K:()=>l});var a=t(7317),r=t(6378);let l=({channelId:e,conversationId:s,parentMessageId:t})=>{let{results:l,status:n,loadMore:i}=(0,a.NE)(r.h.messages.get,{channelId:e,conversationId:s,parentMessageId:t},{initialNumItems:20});return{results:l,status:n,loadMore:()=>i(20)}}},1931:(e,s,t)=>{"use strict";t.d(s,{u:()=>n});var a=t(7317),r=t(7577),l=t(6378);let n=()=>{let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)(null),d=(0,r.useMemo)(()=>"pending"===i,[i]),c=(0,r.useMemo)(()=>"success"===i,[i]),m=(0,r.useMemo)(()=>"error"===i,[i]),u=(0,r.useMemo)(()=>"settled"===i,[i]),x=(0,a.Db)(l.h.upload.generateUploadUrl);return{mutate:(0,r.useCallback)(async(e,t)=>{try{s(null),n(null),o("pending");let e=await x();return t?.onSuccess?.(e),e}catch(e){if(o("error"),t?.onError?.(e),t?.throwError)throw e}finally{o("settled"),t?.onSettled?.()}},[x]),data:e,error:t,isPending:d,isSuccess:c,isError:m,isSettled:u}}},3701:(e,s,t)=>{"use strict";t.d(s,{F:()=>l});var a=t(7317),r=t(6378);let l=({id:e})=>{let s=(0,a.aM)(r.h.workspaces.getById,{id:e});return{data:s,isLoading:void 0===s}}},5849:(e,s,t)=>{"use strict";t.d(s,{x:()=>l});var a=t(7317),r=t(6378);let l=()=>{let e=(0,a.aM)(r.h.workspaces.get);return{data:e,isLoading:void 0===e}}},7824:(e,s,t)=>{"use strict";t.d(s,{b:()=>r});var a=t(5047);let r=()=>(0,a.useParams)().channelId},690:(e,s,t)=>{"use strict";t.d(s,{t:()=>i});var a=t(326),r=t(7577),l=t(1664),n=t(4118);let i=(e,s)=>{let[t,i]=(0,r.useState)(null),o=()=>{i(null)},d=()=>{t?.resolve(!1),o()},c=()=>{t?.resolve(!0),o()};return[()=>a.jsx(n.Vq,{open:null!==t,onOpenChange:o,children:(0,a.jsxs)(n.cZ,{className:"p-0 bg-gray-50 overflow-hidden rounded-xl",children:[a.jsx(n.fK,{className:"p-4 border-b bg-gray-100",children:a.jsx(n.$N,{children:e})}),(0,a.jsxs)("div",{className:"px-4 pb-4 space-y-2",children:[a.jsx("p",{className:"text-sm text-gray-500",children:s}),(0,a.jsxs)(n.cN,{className:"gap-x-2",children:[a.jsx(l.z,{onClick:d,variant:"outline",className:"text-gray-700",children:"Cancel"}),a.jsx(l.z,{onClick:c,children:"Confirm"})]})]})]})}),()=>new Promise(e=>{i({resolve:e})})]}},7886:(e,s,t)=>{"use strict";t.d(s,{H:()=>r});var a=t(5047);let r=()=>(0,a.useParams)().memberId},8674:(e,s,t)=>{"use strict";t.d(s,{u:()=>n});var a=t(2125);let r=()=>(0,a.v1)("parentMessageId"),l=()=>(0,a.v1)("profileMemberId"),n=()=>{let[e,s]=r(),[t,a]=l();return{parentMessageId:e,profileMemberId:t,onOpenProfile:e=>{a(e),s(null)},onOpenMessage:e=>{s(e),a(null)},onClose:()=>{s(null),a(null)}}}},3697:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\Users\email\OneDrive\Desktop\SLACK-CLONE-HAILMARY\zlack-team-chat\src\app\workspace\[workspaceId]\layout.tsx#default`)},3881:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var a=t(6621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};
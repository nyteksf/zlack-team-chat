(()=>{var e={};e.id=979,e.ids=[979],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5807:e=>{"use strict";e.exports=require("module")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},7079:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>c}),a(8192),a(3697),a(6047),a(5866);var t=a(3191),r=a(8716),n=a(7922),l=a.n(n),i=a(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(s,o);let c=["",{children:["workspace",{children:["[workspaceId]",{children:["channel",{children:["[channelId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8192)),"C:\\Users\\email\\OneDrive\\Desktop\\SLACK-CLONE-HAILMARY\\zlack-team-chat\\src\\app\\workspace\\[workspaceId]\\channel\\[channelId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3697)),"C:\\Users\\email\\OneDrive\\Desktop\\SLACK-CLONE-HAILMARY\\zlack-team-chat\\src\\app\\workspace\\[workspaceId]\\layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,6047)),"C:\\Users\\email\\OneDrive\\Desktop\\SLACK-CLONE-HAILMARY\\zlack-team-chat\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\email\\OneDrive\\Desktop\\SLACK-CLONE-HAILMARY\\zlack-team-chat\\src\\app\\workspace\\[workspaceId]\\channel\\[channelId]\\page.tsx"],m="/workspace/[workspaceId]/channel/[channelId]/page",h={require:a,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/workspace/[workspaceId]/channel/[channelId]/page",pathname:"/workspace/[workspaceId]/channel/[channelId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5943:(e,s,a)=>{Promise.resolve().then(a.bind(a,3147))},3147:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>L});var t=a(326),r=a(3240),n=a(949),l=a(7824),i=a(7317),o=a(6378);let c=({id:e})=>{let s=(0,i.aM)(o.h.channels.getById,{id:e});return{data:s,isLoading:void 0===s}};var d=a(9964),m=a(5999),h=a(7577),u=a(7035),x=a(5047),p=a(4046),g=a(7915),b=a(690),f=a(4727);let j=()=>{let[e,s]=(0,h.useState)(null),[a,t]=(0,h.useState)(null),[r,n]=(0,h.useState)(null),l=(0,h.useMemo)(()=>"pending"===r,[r]),c=(0,h.useMemo)(()=>"success"===r,[r]),d=(0,h.useMemo)(()=>"error"===r,[r]),m=(0,h.useMemo)(()=>"settled"===r,[r]),u=(0,i.Db)(o.h.channels.update);return{mutate:(0,h.useCallback)(async(e,a)=>{try{s(null),t(null),n("pending");let r=await u(e);return a?.onSuccess?.(r),r}catch(e){if(n("error"),a?.onError?.(e),a?.throwError)throw e}finally{n("settled"),a?.onSettled?.()}},[u]),data:e,error:a,isPending:l,isSuccess:c,isError:d,isSettled:m}},v=()=>{let[e,s]=(0,h.useState)(null),[a,t]=(0,h.useState)(null),[r,n]=(0,h.useState)(null),l=(0,h.useMemo)(()=>"pending"===r,[r]),c=(0,h.useMemo)(()=>"success"===r,[r]),d=(0,h.useMemo)(()=>"error"===r,[r]),m=(0,h.useMemo)(()=>"settled"===r,[r]),u=(0,i.Db)(o.h.channels.remove);return{mutate:(0,h.useCallback)(async(e,a)=>{try{s(null),t(null),n("pending");let r=await u(e);return a?.onSuccess?.(r),r}catch(e){if(n("error"),a?.onError?.(e),a?.throwError)throw e}finally{n("settled"),a?.onSettled?.()}},[u]),data:e,error:a,isPending:l,isSuccess:c,isError:d,isSettled:m}};var y=a(1190),w=a(1664),N=a(4118);let C=({title:e})=>{let s=(0,x.useRouter)(),a=(0,l.b)(),r=(0,g.m)(),{data:n}=(0,f.i)({workspaceId:r}),[i,o]=(0,h.useState)(e),[c,d]=(0,h.useState)(""),[C,k]=(0,h.useState)(!1),[I,M]=(0,b.t)("Delete this channel?","You are about to permanently delete this channel from your workspace. This action is irreversible."),{mutate:S,isPending:A}=j(),{mutate:E,isPending:L}=v(),_=async()=>{await M()&&E({id:a},{onSuccess:()=>{m.Am.success("Channel deleted successfully"),s.push(`/workspace/${r}`)},onError:()=>{m.Am.error("Failed to delete channel")}})},P=()=>{d("")};return(0,t.jsxs)("div",{className:"bg-white border-b h-[49px] flex items-center px-4 overflow-hidden",children:[t.jsx(I,{}),(0,t.jsxs)(N.Vq,{children:[t.jsx(N.hg,{asChild:!0,children:(0,t.jsxs)(w.z,{variant:"ghost",className:"text-lg font-semibold px-2 overflow-hidden w-auto",size:"sm",children:[(0,t.jsxs)("span",{className:"truncate",children:["# ",e]}),t.jsx(p.RiI,{className:"size-2.5 ml-2"})]})}),(0,t.jsxs)(N.cZ,{className:"p-0 bg-gray-50 overflow-hidden rounded-xl",children:[t.jsx(N.fK,{className:"p-4 border-b bg-gray-100 transition-colors",children:(0,t.jsxs)(N.$N,{children:["# ",e]})}),(0,t.jsxs)("div",{className:"px-4 pb-4 flex flex-col gap-y-2",children:[(0,t.jsxs)(N.Vq,{open:C,onOpenChange:s=>{n?.role==="admin"&&(s&&d(e),k(s))},children:[t.jsx(N.hg,{asChild:!0,children:(0,t.jsxs)("div",{className:"px-5 py-4 bg-white rounded-lg border cursor-pointer hover:bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[t.jsx("p",{className:"text-sm font-semibold",children:"Channel name"}),n?.role==="admin"&&t.jsx("p",{className:"text-sm text-[#1264a3] hover:underline font-semibold",children:"Edit"})]}),(0,t.jsxs)("p",{className:"text-sm",children:["# ",e]})]})}),(0,t.jsxs)(N.cZ,{className:"p-0 bg-gray-50 overflow-hidden rounded-xl",children:[(0,t.jsxs)(N.fK,{className:"p-4 border-b bg-gray-100",children:[t.jsx(N.$N,{children:"Rename this channel"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Channel names must be lowercase and without spaces"})]}),(0,t.jsxs)("form",{className:"p-4 space-y-6",onSubmit:e=>{e.preventDefault(),S({id:a,name:i},{onSuccess:()=>{m.Am.success("Channel name updated successfully"),k(!1)},onError:()=>{m.Am.error("Failed to update channel name")},onSettled:()=>{P()}})},children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Channel name"}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 select-none",children:"#"}),t.jsx(y.I,{value:c,onChange:e=>{let s=e.target.value.replace(/\s+/g,"-").toLowerCase();o(s),d(s)},disabled:A,required:!0,autoFocus:!0,minLength:3,maxLength:80,placeholder:"e.g. plan-budget",className:"pl-7 pr-3 h-10 border-gray-300"})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[c.length,"/80 characters"]})]}),(0,t.jsxs)(N.cN,{className:"gap-x-2",children:[t.jsx(N.GG,{asChild:!0,children:t.jsx(w.z,{variant:"outline",disabled:A,onClick:P,children:"Cancel"})}),t.jsx(w.z,{type:"submit",disabled:!c.trim()||A||c===e,children:"Save changes"})]})]})]})]}),n?.role==="admin"&&(0,t.jsxs)("button",{onClick:_,disabled:L,className:"flex items-center gap-x-2 px-5 py-4 bg-gray-100 rounded-xl border border-gray-200 cursor-pointer hover:bg-rose-50 text-rose-600 hover:text-rose-700 transition-all duration-150 ease-in-out hover:shadow-sm",children:[t.jsx(u.Z,{className:"size-4"}),t.jsx("p",{className:"text-sm font-semibold",children:"Delete channel"})]})]})]})]})]})};var k=a(3265),I=a(198),M=a(1931);let S=(0,k.default)(async()=>{},{loadableGenerated:{modules:["app\\workspace\\[workspaceId]\\channel\\[channelId]\\chat-input.tsx -> @/components/editor"]},ssr:!1}),A=({placeholder:e})=>{let[s,a]=(0,h.useState)(0),[r,n]=(0,h.useState)(!1),i=(0,h.useRef)(null),o=(0,g.m)(),c=(0,l.b)(),{mutate:d}=(0,I.g)(),{mutate:u}=(0,M.u)(),x=async({body:e,image:s})=>{try{n(!0),i?.current?.enable(!1);let t={channelId:c,workspaceId:o,body:e,image:void 0};if(s){let e=await u({},{throwError:!0});if(!e)throw Error("Image URL not found");let a=await fetch(e,{method:"POST",headers:{"Content-Type":s.type},body:s});if(!a.ok)throw Error("Failed to upload image");let{storageId:r}=await a.json();t.image=r}await d(t,{throwError:!0}),a(e=>e+1)}catch(e){console.log(e),m.Am.error("Message failed to send")}finally{n(!1),i?.current?.enable(!0)}};return t.jsx("div",{className:"px-5 w-full",children:t.jsx(S,{placeholder:e,onSubmit:x,disabled:r,innerRef:i},s)})};var E=a(5559);let L=()=>{let e=(0,l.b)(),{results:s,status:a,loadMore:i}=(0,d.K)({channelId:e}),{data:o,isLoading:m}=c({id:e});return(console.log({results:s}),m||"LoadingFirstPage"===a)?t.jsx("div",{className:"h-full flex-1 flex items-center justify-center",children:t.jsx(r.Z,{className:"animate-spin size-5 text-muted-foreground"})}):o?(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[t.jsx(C,{title:o.name}),t.jsx(E.r,{channelName:o.name,channelCreationTime:o._creationTime,data:s,loadMore:i,isLoadingMore:"LoadingMore"===a,canLoadMore:"CanLoadMore"===a}),t.jsx(A,{placeholder:`Message # ${o.name}`})]}):(0,t.jsxs)("div",{className:"h-full flex-1 flex flex-col gap-y-2 items-center justify-center",children:[t.jsx(n.Z,{className:"size-5 text-muted-foreground"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:"Channel not found."})]})}},5559:(e,s,a)=>{"use strict";a.d(s,{r:()=>b});var t=a(326),r=a(7577),n=a(3240),l=a(3456),i=a(3233),o=a(4719),c=a(6032),d=a(7915),m=a(4727),h=a(6801);let u=({name:e,creationTime:s})=>(0,t.jsxs)("div",{className:"mt-[88px] mx-5 mb-4",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold flex items-center mb-2",children:["# ",e]}),(0,t.jsxs)("p",{className:"font-normal text-slate-800 mb-4",children:["Welcome to the beginning of the ",(0,t.jsxs)("strong",{children:["# ",e]})," channel! Created on ",(0,o.WU)(s,"MMMM do, yyyy"),"."]}),t.jsx("p",{className:"text-sm text-slate-600",children:"This is where your team's conversations will live. Share messages, files, and collaborate together in this space."})]});var x=a(3594);let p=({name:e="Member",image:s})=>{let a=e.charAt(0).toUpperCase();return(0,t.jsxs)("div",{className:"mt-[88px] mx-5 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-1 mb-2",children:[(0,t.jsxs)(x.qE,{className:"size-14 mr-2",children:[t.jsx(x.F$,{src:s}),t.jsx(x.Q5,{children:a})]}),t.jsx("p",{className:"text-2xl font-bold",children:e})]}),t.jsx("p",{className:"font-normal text-slate-800 mb-4",children:e}),(0,t.jsxs)("p",{className:"text-sm text-slate-600",children:["This conversation is visible only for yourself and"," ",t.jsx("strong",{children:e})]})]})},g=e=>{let s=new Date(e);return(0,l.z)(s)?"Today":(0,i.g)(s)?"Yesterday":(0,o.WU)(s,"EEEE, MMMM d")},b=({memberName:e,memberImage:s,channelName:a,channelCreationTime:l,data:i,variant:x="channel",loadMore:b,isLoadingMore:f,canLoadMore:j})=>{let[v,y]=(0,r.useState)(null),w=(0,d.m)(),{data:N}=(0,m.i)({workspaceId:w}),C=i?.reduce((e,s)=>{let a=new Date(s._creationTime),t=o.WU(a,"MM-dd-yyyy");return e[t]||(e[t]=[]),e[t].unshift(s),e},{});return(0,t.jsxs)("div",{className:"flex-1 flex flex-col-reverse pb-4 overflow-y-auto messages-scrollbar",children:[Object.entries(C||{}).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-center my-2 relative",children:[t.jsx("hr",{className:"absolute top-1/2 left-0 right-0 border-t border-gray-300"}),t.jsx("span",{className:"relative inline-block bg-white px-4 py-1 rounded-full text-xs border border-gray-300 shadow-sm",children:g(e)})]}),s.map((e,a)=>{let r=s[a-1],n=r&&r.user?._id===e.user?._id&&5>(0,c.X)(new Date(e._creationTime),new Date(r._creationTime));return console.log(e),t.jsx(h.v,{id:e._id,memberId:e.memberId,authorImage:e.user.image,isAuthor:e.memberId===N?._id,authorName:e.user.name,reactions:e.reactions,body:e.body,image:e.image,updatedAt:e.updatedAt,createdAt:e._creationTime,isEditing:v===e._id,setEditingId:y,isCompact:n,hideThreadButton:"thread"===x,threadCount:e.threadCount,threadImage:e.threadImage,threadName:e.threadName,threadTimestamp:e.threadTimestamp},e._id)})]},e)),t.jsx("div",{className:"h-1",ref:e=>{if(e){let s=new IntersectionObserver(([e])=>{e.isIntersecting&&j&&b()},{threshold:1});return s.observe(e),()=>s.disconnect()}}}),f&&(0,t.jsxs)("div",{className:"text-center my-2 relative",children:[t.jsx("hr",{className:"absolute top-1/2 left-0 right-0 border-t border-gray-300"}),t.jsx("span",{className:"relative inline-block bg-white px-4 py-1 rounded-full text-xs border border-gray-300 shadow-sm",children:t.jsx(n.Z,{className:"size-4 animate-spin"})})]}),"channel"===x&&a&&l&&t.jsx(u,{name:a,creationTime:l}),"conversation"===x&&t.jsx(p,{name:e,image:s})]})}},8192:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(8570).createProxy)(String.raw`C:\Users\email\OneDrive\Desktop\SLACK-CLONE-HAILMARY\zlack-team-chat\src\app\workspace\[workspaceId]\channel\[channelId]\page.tsx#default`)}};var s=require("../../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[948,986,621,878,283,854,434,823,749,853],()=>a(7079));module.exports=t})();